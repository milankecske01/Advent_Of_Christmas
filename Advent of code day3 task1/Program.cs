string input = ".......262....300...................507.....961..............668.....................189.906...........................624..................\r\n..148.................805..130..880*...........*684.............*......*..............*..-......%.................$........17...65....91*...\r\n......272.....464.....=......*.........................208*.....260.967.38.......692*.........676............@247..652.585.#......@......74.\r\n.................*734........772......171.........728$.....52........................747.=866............350...........*....................\r\n..328....21...........941......../.....*...243................429@......567$...623.................654..#.....*815....360......812%.........\r\n..........$.....%....@....6....583.....598...&.114@...618......................+...............156.........817...../.................340....\r\n.....883........359.....*.*..........................*............@............................./...920............302.712...........*......\r\n........*.....*......100..192.160........791......843...680*643.252.................322...354..........*.....+.........*............556.....\r\n.........958.580.................*.............................................879.....-..$............633...63......561.....289............\r\n..............................745.......221..504-................356..............*827........355...............................*46.........\r\n...................206..382...........$...........142@.105...534........./.......................*..........535.....................515.....\r\n..201.....336.......-..*.....268..121..775...-...........%..............791.............129...449.....450..*.........790...........*........\r\n............%.559*......7.....+..*..........865......895............930.....427..242......#...............414.830............37..809........\r\n..................85.............466..550-..........+....................44...*...*.........361..215..........*......808.220*...............\r\n................*......709....................577......430...&..148........*.696.988....801.*.....*..........202..25..*.....................\r\n.....636......14...........372.............64...*...........586.%...15..241.............&....387..447...............*..811....146...........\r\n.....-...........892*226....*....161.........%.623..................*...........$...............................................&.....657...\r\n........987.................147.=....+.254..........887........773...321.....221....415.971..................74.......702..212..............\r\n......@............182............335.....*...........*..77.......#......................./.....29..........%...........&..*.......872......\r\n......643............*...................756.........677.*..........251......521..620......................................685.206.......132\r\n............274*...........929.................871........686.542..%........*......*.......................882....756.............*859..*...\r\n................516.........*.....................*..............*...289...10.....890..985...258...963...............*.................526..\r\n.............................610...............857........210..818......*.......@.........#..=......*.....968.........42..........732.......\r\n.............../..*453.................467..........376......$..........429..218.....................955..%..............357................\r\n.......841....493..............830#.......*342.........*........*................./....562....945................224.......*..435...........\r\n..................843.803......................2........56...248.560.............281.....*.......*.........-........*5....728..*......156...\r\n...822*288....352.*...+..............$.........$........................@..............794......539..-814..528.81.......+.......687.....*...\r\n................*.783..../454.859....809..742........................663...267/..................................*.....847..............167.\r\n....&371.296.484..............*..........=...........516.......925...............................#................441...............224.....\r\n.........#............594..417....458............112*.....65.....#.....337...357....#..369*277.825....386..................212..............\r\n................651..#...........*.....$..................*............*.....*...125...................*......497.........*..............509\r\n......320..........*......-...883..989..733.....668.905...997.......454.....353...........946....18.....340...&......515...774........*.....\r\n......-.....880....476...955.......=................*...........58.....................23....*69.+..102..............*.............933.687..\r\n........931....*..............................757....602.983......-..822..............*.............*.......732.....15......................\r\n....../....*....463.............183$..961........*.......*....#...........572......618.............52..........@........205......*....&429..\r\n...204......550............-.........%.........628.....240..588............*................................/..........*......167.776.......\r\n................360....*....69..........*..........534..................%..340.....................885*912..52......949.....................\r\n.........483......*..46.754......-....607.346.....*..............851.302..................@....................-........330.-201............\r\n.........@...274.811..............819...........56......326......................496....650...........382......168.420...*.........452......\r\n..............#........325.449........581...........112*........................+............163.......*.................407.......*...460..\r\n......595.........*......*...................226+.................268..153.........#123........*.....$..877..........#..........361...*.....\r\n......*........280.287.427...........755...........................%.........................722...323................307...................\r\n..132.553...............................*.......117......450.109...............849.....749.................................105..537#..741...\r\n...*.................................788.......*....691...%...$............148.....960..*....512.728#..544.624.....$......*.................\r\n.523..97...186..907....508....................739......*................*.....*856.&....15..................$.....911.......&..877..632.....\r\n..............*.*.........*.........161*....+........381.............453.376..........................30..................806.......*.......\r\n............560.877...773...............168..446..............465..............435@..24..622...%.................................=..347.....\r\n...*165................-.......................................*......@816..............*....313..421......269....539.49.530..113...........\r\n768......*626.926....=.....676...981=............703.........682.&141....................444......=........@.........*......*......539......\r\n......159.......$..362......../.......254.....14..=...............................219.................383.........*......182.............733\r\n.324........879.....................*.=...............316.....*480......*............*............439*.........621.961.......*481...........\r\n....*...208*...........188.......763.....553...........*...957.......771.944........445......4...........375..............174.....903.665...\r\n.................651........851.......37*...........303.................................446......61......*......346................@...*....\r\n......160....412*......../.....=.220.........354.........-.....838...........473..........#........$.870.......*............*........391....\r\n.....*....................218.....*.............*.....739..320*.........358....*...521......383.........*.....27...........107..............\r\n...969...718..................+....200.534.237+..........................=..889....*..........@........396.......................103..243...\r\n........&..................841...-......&........./748...655..325.................430............813.................618.....687...#..@.....\r\n..........825...761............800......................*....&...........496............652...$..*...............206..*.....................\r\n...................+....&584.........35..663*590.....677...................*........741*....908...293..918............570....$......%.......\r\n...........794.......................&...................852*...........361...............-.................................502.769.82......\r\n..535.......$............523*522................-..............847..........593..........267.....................................*..........\r\n....*...........73...............................299..262..941*..................813..............682..........877........494...411.........\r\n..528................*997....*...477........464.....................521........@....*315......#...=..............*..........................\r\n............669...909.......342..*...........*..........444@...@.....-..611.911..............864......114....555..628..890..................\r\n............*.....................444.....921................783.......*.......................................*........=...414.............\r\n..........622..................................422..-...............404......&906..381............438..........605.........@.....389.352@...\r\n....77.........519...282........720.....159=..*....87......225.605......125...........+.............*..860-......................=..........\r\n...$...556.......-.....*..........#..........479............&....*.........*967...343..............400...........*883..................*881.\r\n......*............207.653....113...359............227............357............*..........771...........426.905..............313..563.....\r\n...74..233....959../.........*.........&............*...#.................543..64..*....179................*........@.............*.........\r\n.....*..........*.......707.341..........&489.....206..132..407..........*........224..*................310........255./.........136........\r\n...251.......770........................................................475.............694....514.....................236..................\r\n........944........-379...............403.....934......47........................................*..............694........359..............\r\n732.............14..........*..........*.........*.................720....325..............375.483.............*.....356&..............686..\r\n.......160..672*.........250.125....791.....&76...1.....&963...422..#........../....191......*................925..........771...405&.-.....\r\n...205....%......402................................117........*.........887....509..........44.....417.................=.-.................\r\n...................*............=..145......746.......*........861..804....*.........313...............*....*.........761.......638.........\r\n..852..767.....#67.835......$.359..*..................789.@................675.938.............957..........459.652..............*...949....\r\n........*.................977.....779.......348...627.....136.........+623..........964.............948+..........*.................=.......\r\n........882......+............................./...#...............................*......311...152.......186......233.......374.......989..\r\n..148.........125.....931......706%....#...379.........................181.......227..........*..........*..............581..*..............\r\n.....*..179..............*.............970.../.......605...........736*......................700......970.................*.........+.487...\r\n....209...*..............810....790..............787*......................#...+....-...824......587......709*.....899.....283....324..*....\r\n...........50...750............./.......633...............................364..66..593./......................115......-..............561...\r\n...................#......989..............*217.......................620...........................................740.....*361....+.......\r\n..........266.........647*....$..992....*...........318...345...........*..............-........252..797.................354........8...110.\r\n.............................375.....344.334.......*.......*..........460......558.....364.......#..$...........@....%..........3...........\r\n...$14...314...652...............................626............%...................%.....................778....868..215...................\r\n...........&....*.......$........241.................*796....552..738..#234...@....358............993....*..................................\r\n................594..230..-..647*.....&............56.............*............479.....921..............519................426......713.....\r\n.....944*................404........53..349....$........459......986..+......=..............-666..............237...897#..*........&....755.\r\n.........176........280......714..........*..876.268...*.............946.492.113..........*..............................855................\r\n.....................*........*...936..................973.................*............736.......844.659....652.@............266...547.....\r\n...677......@........426.....89........./...................185..........630.285............196...../....*...*....349....102....*....*......\r\n........765..677................*..46....85.901.....*...440...................../..........*.............304..952............1........507...\r\n...........=.........669......847....*........*..821......*.301.......880.................829.951.460....................876................\r\n.................466*......*.........69.....207.........419...*...................442............*...........-.....898.....=.667............\r\n....421.56=................318....................................178...............+...............896*855...522..&..........%....151*405..\r\n....*.......481-...70*401..............550...................*.......*296...91........998.566..112..........................................\r\n...235.472..............................*......962....963.935...921.........+.....................-...........168.....=516.304...416*699....\r\n........#...*10.................240=.....687..*...................*.475..-...........697.......................*..............*.............\r\n..261.....47.......750....954.........=......274........-...203.570....*..71...........*...484..*.....%61...397..854...#.......523.....931..\r\n..............34............$....%.....500........216.647............271.......908....906.......488...............*..92..634................\r\n..........83*....................994.......511.55*........991...16.........417*....*......96...................697.................&........\r\n.............582.450=.....................................=.....*...............654.411........313..................29.........32.849.......\r\n.......563..............239.........&.............405............193......+.411.........%......*...&.....623.........$....+748..=.....840...\r\n..........&......#.......-....761....639.275+.......*...................69..$....../.233..@..88.....226...*.....366................../......\r\n.............248.16............/...............+...556...........306............354......308..............682.../......894...#..............\r\n..697.......*.........@..........959...125....297.......................*337...................72....108...............*......991.344....781\r\n...*.......715...49.392.........*.......*................652/........#.......55*.......................-.844......./..344..........-........\r\n...591....................334.701.......838.......................397....501....759.....-.........................946.......442.............\r\n..................557*421...@.....749........500..........#170..........%............941..373....425..818.......................828.....237.\r\n..793*144...........................$.302....*.....938*..................................*..........*....%.378........66..63...*............\r\n............474...............893............267.......810................585..........558.......694......../.................340.701.......\r\n..............#..798......332*.....855.....................592.589........&.....833=.........199......730.......+......177..................\r\n.................*..................*.........................*........................#.......*......*.....154.589...*.....................\r\n.....64*809........../............@.139............228..374....../.......771.........534........281...........*......506.......=............\r\n..............427.750......546...98............707..=......&..381..877..*..........*........6.........%......489.........../.795............\r\n...895.805*.....*.....................*694....=........848...............616.....69.86.....*..460......895.......544.....651.......14.886...\r\n...........390...850..777.534..138..52..........570....@.........812.$71................795.......557............-.....................*....\r\n..46*41...............*...........*................@.........613*.................584.......=........*...............106*....627.602....829.\r\n........217*380.............721..928.873...........................593..353...............341..430..989..923.............695......-...%.....\r\n..................586.......$.........*...207.......585&......485..*...*..........................*......*..........................929.....\r\n............#.154*.....60.............95.......................*..138.764..........................425.275......%.331*664..854..........887.\r\n908.917..359........../........659........125..785...........499..........991....358..........102*...........903..........*.....409....-....\r\n...*.........963*.../......408.............%........830*871...............*......*...828..........764.671................293...*............\r\n....................559....=..........81............................391...969.513....*.......991........&..518.....208*.......75............\r\n.....461.560*......................../........950.........320%.....*................97........................#..........+675.....352...339.\r\n......*......439.%101.709...302.870......838....@.....594........953.......514*862........339....................................*..........\r\n...247...................@......*.................312....#.................................-...271..800...@..818.850....333*722...330..951..\r\n........922.................184.666.............../..........................356...105.........#...*.....353./........................*.....\r\n832.....-.......758...800....$......................337.......419...........=.......*...258........926.........................../592..186..\r\n...................+...........220.287...117....783......646..#.........451........750..........27.....$.......*750......890................\r\n........719............982....%.......*..*.........*144.*..................*...........*764./.....*373..368.201..........@..................\r\n......../..........388....*........115...432.............594............345..658$...442......833.................408.........=..........542.\r\n..........27.#498..*.....286..+490...............................966.....................262.......................#..542.237...............\r\n72....251..#.......667.....................282..556..260...........%.$......................*....107..................*.....................\r\n.......*.......*..............................*..-...*...............64..#...=.....402..@....790.@.....................295.766...484..969...\r\n......85....882.80.......184$................117........................454..583......*..351...............266....................&....*....\r\n.......................................................48...........................436........275...................869............258.....";
/*
string input = "..55\r\n" +
               "....\r\n" +
               "72..\r\n" +
               "....\r\n" +
               "....\r\n";*/
int width = input.IndexOf('\r');
input = input.Replace("\n", "");
input = input.Replace("\r", "");
string numbers = "0123456789";
int[] indexes = new int[2];//first and last index of number
int output = 0;
for (int i = 0; i < input.Length; i++)
{
    if (numbers.Contains(input[i]) == true)
    {
        indexes[0] = i;
        for (int k = i; k < input.Length; k++)
        {
            if (numbers.Contains(input[k]) == false)
            {
                indexes[1] = k - 1;
                Console.WriteLine($"Number found: {input.Substring(indexes[0], indexes[1] - indexes[0] + 1)}");
                if (IsPartNumber(indexes))
                {
                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.WriteLine($"number is partnumber");
                    Console.ForegroundColor = ConsoleColor.White;
                    output += int.Parse(input.Substring(indexes[0], indexes[1] - indexes[0] + 1));
                    Console.WriteLine($"{output}\n");
                    //Console.WriteLine(input.Substring(indexes[0], indexes[1] - indexes[0] + 1));
                }
                else
                {
                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.WriteLine("number isn't partnumber");
                    Console.ForegroundColor = ConsoleColor.White;
                }
                i += indexes[1] - indexes[0] + 1;
                break;
            }
        }
    }
}
Console.WriteLine(output);
bool IsPartNumber(int[] indexes)
{
    bool leftside = indexes[0] % (width) == 0 ? true : false;
    bool rightside = (indexes[1]+1) % (width) == 0 ? true : false;
    if (indexes[0] > width)//top
    {
        if (!leftside && IsSymbol(input[indexes[0] - width - 1]))//top left diagonal
        {
            return true;
        }
        if (!rightside && IsSymbol(input[indexes[1] - width + 1]))//top right diagonal
        {
            return true;
        }
        for (int i = indexes[0] - width; i < indexes[1] - width+1; i++)//top row
        {
            if (IsSymbol(input[i]))
            {
                return true;
            }
        }
    }
    if (!leftside && IsSymbol(input[indexes[0] - 1]))//left
    {
        return true;
    }
    if (!rightside && IsSymbol(input[indexes[1] + 1]))//right
    {
        return true;
    }
    if (indexes[0] < input.Length - width)//bottom
    {
        if (!leftside && IsSymbol(input[indexes[0] + width - 1]))//bottom left diagonal
        {
            return true;
        }
        if (!rightside && IsSymbol(input[indexes[1] + width + 1]))//bottom right diagonal
        {
            return true;
        }
        for (int i = indexes[0] + width; i < indexes[1] + width+1; i++)//bottom row
        {
            if (IsSymbol(input[i]))
            {
                return true;
            }
        }
    }
    return false;
    bool IsSymbol(char character)
    {
        if (!numbers.Contains(character) && character != '.')
        {
            return true;
        }
        return false;
    }
}